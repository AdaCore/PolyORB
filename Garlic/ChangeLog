Mon Feb 10 15:11:20 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* test_threads.adb: New file which tries to determine if 
	  thread-blocking IOs are available on the current target.

Fri Feb  7 17:29:15 1997  Laurent Pautet  <pautet@lglsun11.epfl.ch>

	* s-parint.ads: Force body elaboration. Workaround to be removed
 	as soon as elaboration of generic package instanciation is fixed.

Fri Feb  7 11:35:42 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* constants.sh: Added O_RDONLY and O_WRONLY to the list of
	  constants.

	* s-garrem.adb: Avoid using dup2() because of a bug in Linux
	  threads library handling of this call along with non-overloaded
	  functions: MIT pthreads library use an internal file table which
	  is mapped on the process file table. When dup2() is used, the
	  pthreads library doesn't really call the dup2 system call but
	  use its mapping table to replace calls to the new descriptor by
	  calls to the old one; before this, it closes the new descriptor
	  if it was already opened to preserve dup2() semantics. When
	  another system call such as getsockname() is used and is not
	  overloaded by the pthreads library, then the file descriptor
	  passed to the kernel is the one seen by the application, that is
	  the one assigned by the threads library, which do *NOT*
	  correspond (because of the close() performed to simulate dup2())
	  to the one assigned by the kernel itself. This causes such
	  operations to fail with EBADF (bad file descriptor).

Thu Feb  6 17:51:34 1997  Laurent Pautet  <pautet@lglsun11.epfl.ch>

	* s-parint.adb: More comments. Suppress
 	Public_Receiver_Is_Installed because never used.

Thu Feb  6 16:45:34 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* constants.sh: Replaced gnatk8 by gnatkr.

Wed Feb  5 18:58:18 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* s-gartcp.adb: Removed every ATC in the TCP module by using 4
	  characters operation codes which will unblock all the peers if
	  needed after shutdown synchronization.

Tue Feb  4 14:56:48 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* s-gartcp.adb: Commented out an ATC which makes everything
	  block. Without this ATC, termination may fail in some peculiar
	  cases (see comment in file, prefixed with 'XXXXX').

Mon Feb  3 20:20:56 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* s-parint.ads: Removed the kludge about Unit_Name. Since we are
	  not close yet to work with 3.09, it is not necessary. If we
	  decide to make a release which works with 3.09, then this kludge
	  will be added again.

Wed Jan 29 19:52:13 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* s-parint.ads: Minor reformating.

Tue Jan 28 16:18:41 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* ChangeLog: Removed spurious blank line introduced by the last
	  check-in !

	* s-parint.ads: Change '???' into 'XXXXX' which is our way of
	  indicating portions of code that are either not quite perfect or
	  likely to be modified in the future (workaround for
	  example). Also capitalize the explanation, to be style
	  conformant.

Tue Jan 28 16:11:53 1997  Laurent Pautet <pautet@inf.enst.fr>

	* s-parint.ads: Change Unit_Name_Access definition in order to
	workaround a bug in GNAT 3.09.

Wed Jan 22 17:32:39 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* constants.sh: Use the current build directory instead of /tmp as
	a temporary dir to prevent blow up due to /tmp being full (shit
	happens!).

Tue Jan 14 18:34:50 1997  Laurent Pautet  <pautet@quasimodo.enst.fr>

	* s-parint.adb: Get rid of Htable (overkilling).

Tue Jan 14 10:06:14 1997  Laurent Pautet  <pautet@inf.enst.fr>

	* s-garhea.adb: Barrier -> Barrier_Type in Garlic.Utils.

	* s-parint.adb, s-parint.ads: It was not possible to query several
 	client elaboration requests from the same partition when the first
 	request was pending. Abortion of first RPC was unsafe and would
 	let the unit table in an inconsistent state. Synchronisation is
 	now a little bit less complex than it was. Restarting a partition
 	is now fully implemented (works on any partition, and not only on
 	boot partition). Code is a little bit cleaner.

Mon Jan 13 17:23:31 1997  Laurent Pautet  <pautet@inf.enst.fr>

	* s-garuti.ads, s-garuti.adb: No longer private to use it in
 	s-parint. Add a new semaphore type (with useful procedures to deal
 	with arrays).

Mon Jan 13 13:41:33 1997  Samuel Tardieu  <sam@inf.enst.fr>

	* s-rpc.adb: Changed prototype of Public_RPC_Receiver to match the
	access type whenever taking the 'Access at registration time.

	* s-parint.adb: Idem.

Thu Jan  9 14:24:40 1997  Laurent Pautet  <pautet@inf.enst.fr>

	* s-parint.adb: Implementation of partition restarting. Add a new
	procedure Invalidate_Receiving_Stub used by the programmer to
	signal to GARLIC to invalidate RNS info on a given partition and
	to the client cache to invalidate the old value and to query a new
	one.

	* s-garhea.ads, s-garhea.adb: Add a callback fonction to notify a
 	partition error to System.RPC. Add a registration procedure to
	enable System.RPC to register its callback.

	* s-rpc.adb: Provide a callback to be notified of partition
	error. This procedure unblocks pending RPCs with the dead
	partition. Requests table contains the partition id used for the
	associated RPC.

Fri Dec 20 12:10:08 1996  Laurent Pautet  <pautet@scapin.enst.fr>

	* s-stratt.adb: Raise Data_Error if an integer cannot be mapped
	onto its equivalent XDR integer.

Thu Dec 19 12:54:45 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-parint.ads: Added dummy functions for Shared_Passive (needed
	  for the stub expansion).

	* s-parint.adb: Idem.

	* s-gartcp.adb: Removed a conversion between Interfaces.C.int and
	  pointer types because of a possible clash on 64 bits machines.

Mon Dec 16 15:26:02 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-partyp.ads: Removed.

	* rci_info.ads: Removed (included in s-parint.ads).
	
	* rci_info.adb: Removed (included in s-parint.adb).

	* s-parint.ads: Inclusion of RCI_Info generic package.

	* s-parint.adb: Ditto.

	* Makefile.am: Removed rci_info.ad[bs] from file list.

Sat Nov 30 21:01:19 1996  Laurent Pautet  <pautet@quasimodo.enst.fr>

	* s-garopt.adb: For sure, serial is not the default protocol.

Fri Nov 29 12:43:07 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-garela.adb: Replaced by an empty package.

	* s-garter.adb: On the boot server, launch the termination task
	  only if this partition is not permanent. On other partitions,
	  reject global termination if the partition is permanent.

	* s-garopt.ads: Added support for the new 'Permanent attribute.

	* s-garopt.adb: Ditto.

Thu Nov 28 22:33:30 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* Makefile.am: Adapted for new elaboration packages.

	* two.py: Serial-line connector simulator (connects two sockets).

	* serial.c: Serial-line simulator using sockets. Changed procedure
	names to match the ones used in Spif.

	* s-gaseli.adb: Optimization. Changed procedure names to match the
	ones used in Spif.

	* s-garhea.adb: Added debug entries.

	* s-garela.adb: Removed useless faulty lines (do not work with
	serial protocol).

	* s-rpc.adb: Handle task non-abortion (which is quite frequent :-)
	more elegantly than before. It also corrects a strange
	segmentation fault in GNAT runtime which appeared only when
	debugging was off (that is a fast succession of events, probably a
	race condition in protected objects and entry family handling).
	
Wed Nov 27 18:42:47 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-stratt.adb: Added pragma Suppress for range and overflow
	  checks.

	* s-gaseli.adb: Changed the protocol to make it simpler.
	  Changed this stupid protocol one more time.

Tue Nov 26 15:52:33 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-ganobl.adb: Changed the safety delay to be 0.5 seconds.

Sat Nov 23 16:57:56 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-gartcp.adb: Added missing constant.

Thu Nov 21 19:45:25 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-gartcp.adb: Protect against very early internal error which
	  could propagate even when it's not fatal.

	* s-rpc.adb: Do not wait on protected entry in a finalization
	  procedure called during abortion. A flag showing that the result
	  will have to be invalidated when it arrives is set instead, thus
	  providing a much better respect of the semantic of abort (abort
	  very quickly) instead of waiting for the answer. If the answer
	  was there already, it's discarded.

Tue Nov 19 16:56:07 1996  Laurent Pautet  <pautet@quasimodo.enst.fr>

	* s-garela.adb: New package provided to set usual defaults.

	* s-garopt.adb: Add Set_[...] (Default : [...]) corresponding to
	Get_[...] return [...] in order to set defaults during elaboration
	of a new package system.garlic.elaboration.

	* s-gaprco.adb: Change System.Garlic.Config.Create into
	[...].Initialize.

Wed Nov  6 18:34:57 1996  Laurent Pautet  <pautet@inf.enst.fr>

	* s-gartcp.adb: sin_family was no longer initialized AF_INET.

Tue Oct 29 12:58:51 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-ganobl.adb: Use s-gaosli's C_Errno.

	* s-garnam.adb: Idem.

	* constants.sh (constants): Removed useless constants.

	* Makefile.am: No need for special
	  dependencies with the new mkdep in fact, provided that the
	  Makefile.in that is distributed contains these dependencies !

	* s-garthi.ads: Removed dependency on System.Garlic.Constants.

	* Makefile.am: Added s-gaosli.*.

	* s-gaosli.ads: New file with Getenv.

	* s-gaosli.adb: Idem.

	* s-garopt.adb: Use System.Garlic.OS_Lib's Getenv.

	* s-gardeb.adb: Idem.

	* s-garthi.ads: Added interface to system's getenv() function.

Fri Oct 18 14:12:03 1996  Laurent Pautet  <pautet@quasimodo.enst.fr>

	* Makefile.*: Include s-gaprco.*, s-garloo.*

Thu Oct 17 19:18:17 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-garsta.adb: Two typos.

Thu Oct 17 08:53:59 1996  Laurent Pautet  <pautet@quasimodo.enst.fr>

	* s-garloo.adb: Skip Header.

	* s-garhea.adb, s-rpc.adb: Let send a message to myself.

Wed Oct 16 21:32:52 1996  Laurent Pautet  <pautet@quasimodo.enst.fr>

	* s-gaprco.adb, s-gaprco.ads, s-garsta.adb: The body of this
 	package should be built during GARLIC installation. It should
 	contain a registration of all protocols provided in the DSA
 	distribution.

Sun Oct  6 15:17:18 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-gsmasp.ads: New file.

	* s-garser.ads: New file.

Mon Sep 30 16:13:29 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* Makefile.am: Would look for s-gtplsp.ads in the bad place.

Sun Sep 15 17:27:30 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-garhea.adb: Added an Emergency_Stop in the Shutdown procedure
	  (see the procedure for explanation).

Thu Sep 12 14:55:27 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* mkdep: Change the way dependencies are generated. This one seems
	  to be the good one.

	* s-garter.adb: Don't check Get_Active_Task_Count during the
	  second termination phase to avoid unexpected rejection of
	  termination.

Wed Sep 11 19:43:48 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-garhea.adb: Added the framework needed to free an unused
	  Partition_ID.

Tue Sep 10 10:21:53 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* Makefile.am: Added s-stratt.adb and s-stratt.o to the list of
	  installed files.

	* s-garthi.ads: Added an (ugly) use type clause for
	  Interfaces.C.int.

Fri Sep  6 17:52:46 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-garter.adb: Added spec for Get_Active_Task_Count.

	* s-garter.ads: Removed Get_Active_Task_Count from spec.

Mon Sep  2 18:03:05 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-stratt.ads: Added.

	* s-rpc.ads: Removed the offending declaration.

	* s-rpc.adb: Allow mixed Read and Write calls. Allocate Node
	  packets during the first Write call.

Fri Aug 16 12:36:11 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-parint.adb: Added a pragma Elaborate_All for
	  System.Garlic.Startup.

Tue Aug 13 13:43:00 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* Makefile.am: Added s-garpri.{ads,ali,o}.

	* s-garpri.ads: New file defining static priorities.

	* s-rpc.adb: Take priorities into accounts (transmit priorities
	  from end to end and use static priorites for other tasks).

	* s-garter.adb: Idem.

	* s-gartcp.adb: Idem.

	* s-ganobl.adb: Idem.

Mon Aug 12 16:13:54 1996  Samuel Tardieu  <sam@inf.enst.fr>

	* s-garthi.ads: Fixed (it won't compile (from R. Dewar) in the
	  newest GNAT release).

	* s-gaphlo.ads: Use pointers instead of controlled objects for
	  efficiency.

	* s-gaphlo.adb: Idem.

	* s-ganobl.adb: Added two "with abort" which were missing.

	* s-rpc.adb: More debugging information.

	* s-parint.adb: Idem.

	* s-gartcp.adb: Idem.

	* s-ganobl.adb: Idem.

	* .cvsignore: Added s-gtplsp.ads into the ignore list.

	* s-garhea.adb: Added a partition cache to improve response time.

