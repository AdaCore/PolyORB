\chapter{Implementation choices to upgrade AdaBroker to CORBA 2.3}

\section{Implementation of the object hierarchy}
CORBA specifies that the role of CORBA.AbstractBase.Ref and
CORBA.Impl.Object is to provide reference counting and smart pointer
semantics. These features are implemented in broca in the Broca.Refs
packages. Figure~\ref{fig::detailed_hierarchy} shows the
full inheritance graph.


\vspace{2mm}
\begin{figure}[!htbp]
    \includegraphics[width=1.1\textwidth,clip=]{hierarchy.ps}
  \caption{The detailed object hierarchy.}
  \label{fig::detailed_hierarchy}
\end{figure}


\paragraph{}When an instance of Broca.Refs.Ref is initialized or
adjusted, it increments by one the counter of the Broca.Refs.Entity it
points to. When a Broca.Refs.Ref is finalized, it decrements the
counter of the Broca.Refs.Entity it points to, and frees the memory if
this counter reaches 0.

\paragraph{}The Broca.Refs.Ref type is often derived, but never
extended. On the other hand, \\ Broca.Refs.Entity is the root of all
types that really contain data, it is often derived and extended.

%%\section{Implementation of the To\_Ref functions}



\section{Future work}

\paragraph{}Several features of CORBA 2.3 are not curretly supported
in AdaBroker.

\begin{itemize}
\item Local interfaces. (It should not require too much work).
\item Delegating servants
\item Abstract interfaces. This requires more work since their
semantics is linked with valuetypes.
\end{itemize}
