AC_INIT(src/polyorb.ads)
AC_CONFIG_AUX_DIR(support)
#
# Initialization
#
AC_CANONICAL_SYSTEM
AM_INIT_AUTOMAKE(polyorb,0.1)
LIBVERSIONINFO=0:0:0
AC_SUBST(LIBVERSIONINFO)
#
# IR
#
#AC_MSG_CHECKING([whether to build the Interface Repository])
#ir_enabled=no
#AC_ARG_ENABLE(ir,
#[  --enable-ir             Build the Interface Repository (no)],
#[ir_enabled=${enableval}])
#AM_CONDITIONAL(ENABLE_IR, test x$ir_enabled = xyes)
#AC_MSG_RESULT($enable_ir)
#
# Check for maintainer mode
#
AC_ARG_ENABLE(debug,
[  --enable-debug          Turn on debugging options],
[GNATFLAGS="-g -O2 -Wall -gnaty3bcefhikmt -gnatfag -gnatwu -gnatwe -gnatwl"
# XXX removed -gnato because it consumes one register.
 debug=true],
[GNATFLAGS="-g -O2"
 debug=false])
AC_SUBST(GNATFLAGS)
AM_CONDITIONAL(DEBUG, test x$debug = xtrue)
#
# Various programs
#
AC_PROG_CC
AC_PROG_INSTALL
AC_CHECK_PROG(RM, rm, rm)
AM_PROG_WORKING_ADA
AM_CROSS_PROG_WORKING_ADA
AC_EXEEXT
AC_CHECK_PROG(GNATMAKE, gnatmake, gnatmake)
AC_CHECK_PROG(GNATCHOP, gnatchop, gnatchop)
AC_CHECK_PROG(PYTHON, python, python)
AM_PROG_LIBTOOL
#
# Check that the GNAT version is recent enough for this version of GLADE
#
AM_ADA_PREREQ(20010503, 3.14a1)
#
# Output
#
AC_OUTPUT([Makefile
	   compilers/Makefile compilers/idlac/Makefile
	   compilers/idlac/testsuite/Makefile
	   compilers/idlac/platform.ads
	   src/Makefile src/corba/Makefile support/adacompiler])
for a in src/gnat.adc
do
  echo "creating $a"
  cp $srcdir/$a $a
done
# src/polyorb-config])
