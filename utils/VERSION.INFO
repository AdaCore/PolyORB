#!/bin/sh
#
# VERSION.INFO,v 1.11 1996/05/24 14:05:48 tardieu Exp
#
# This file will perform version substitution when building a release. It
# has to be tagged "to_be_released" and to be kept in synch as new releases
# appear.
#
# DO NOT CALL THIS FILE EXPLICITLY. IT WILL BE CALLED BY THE make_distrib
# program.

#
# If there is an argument on the command line, use it for the version number
#

if test x$s = x; then
  x=false
fi
if ! $s; then
  adabroker_version=`echo $1 | sed -e 's/^[^-]*-//'`
else
  #gnat_version=`sed -n -e '/Gnat_Vers/s/[^"]*"\([^" ]*\).*/\1/p' ada/gnatvsn.ads`
  adabroker_version=`sed -n -e '/New features/s/[^0-9]*\([0-9.]*\).*/\1/p' NEWS | head -1`
fi

#
# files hold the list of files in which substitutions will occur
#
#files="README INSTALL Dist/xe_usage.adb Doc/install_guide.txt"
files="README"

#
# Do the job
#
for i in ${files}; do
  mv $i $i.orig.$$
  sed -e "s/@adabroker_version@/${adabroker_version}/g" < $i.orig.$$ \
    > $i
  rm -f $i.orig.$$
done
